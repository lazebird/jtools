import{r as ref,c as computed,a as resolveComponent,o as openBlock,b as createElementBlock,d as createVNode,w as withCtx,u as unref,e as createBlock,f as createCommentVNode,p as pushScopeId,g as popScopeId,h as createBaseVNode,F as Fragment,i as renderList,j as withKeys,k as createTextVNode,n as nextTick,t as toDisplayString,l as createApp,A as Antd}from"./vendor.665d4a49.js";const p=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}};p();var xmlparser_vue_vue_type_style_index_0_scoped_true_lang="",_export_sfc=(a,t)=>{const o=a.__vccOpts||a;for(const[s,n]of t)o[s]=n;return o};const _withScopeId=a=>(pushScopeId("data-v-7048e968"),a=a(),popScopeId(),a),_hoisted_1={class:"example"},_hoisted_2=_withScopeId(()=>createBaseVNode("a",{href:"https://github.com/lazebird/xliff-helper",target:"_blank"},"@lazebird/xliff-helper",-1)),_hoisted_3=createTextVNode(" + New Tag "),_hoisted_4=_withScopeId(()=>createBaseVNode("br",null,null,-1)),_hoisted_5=_withScopeId(()=>createBaseVNode("label",null,"XLIFF/XML File ",-1)),_hoisted_6=_withScopeId(()=>createBaseVNode("br",null,null,-1)),_hoisted_7=_withScopeId(()=>createBaseVNode("label",null,"JSON File ",-1)),_hoisted_8=_withScopeId(()=>createBaseVNode("br",null,null,-1)),_sfc_main$1={setup(__props){const columns=[{title:"ID",dataIndex:"id"},{title:"Source",dataIndex:"srcText"},{title:"Target",dataIndex:"tgtText"},{title:"New",dataIndex:"newtgt"}];var xmlDoc;const action=ref({searchVal:"",postFunc:'(s)=>s.replace(/id\\s*=\\s*\\"\\s*(\\d+)\\s*"/g, "id=\\"$1\\"")'}),conf=ref({idName:"id",unitName:"trans-unit",srcName:"source",tgtName:"target"}),map=ref([]),ignPats=ref(["SWITCH.*#"]),newtag=ref({input:!1,val:""}),inputRef=ref(),filterData=computed(()=>map.value.filter(a=>!action.value.searchVal||a.tgtText.indexOf(action.value.searchVal)!==-1||a.srcText.indexOf(action.value.searchVal)!==-1));function str2file(a,t){var o=document.createElement("a");o.setAttribute("download",t),o.style.display="none";var s=new Blob([a]);o.href=URL.createObjectURL(s),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function removeTag(a){ignPats.value=ignPats.value.filter(t=>t!==a)}function handleInputConfirm(){newtag.value.val&&ignPats.value.indexOf(newtag.value.val)===-1&&(ignPats.value=[...ignPats.value,newtag.value.val]),newtag.value={input:!1,val:""}}function showInput(){newtag.value.input=!0,nextTick(()=>{inputRef.value.focus()})}function isIgnore(a){for(const t of ignPats.value)if(new RegExp(t).test(a))return!0;return!1}function XML2obj(a){var t=a.target.result,o=new DOMParser;xmlDoc=o.parseFromString(t,"text/xml");var s=xmlDoc.querySelectorAll(conf.value.unitName);for(const n of s){const r=n.querySelector(conf.value.srcName),c=n.querySelector(conf.value.tgtName);map.value.push({id:n[conf.value.idName],source:r,target:c,srcText:r.innerHTML,tgtText:c.innerHTML})}}function Json2obj(e){var a;var text=e.target.result,obj=JSON.parse(text);let postFunc=action.value.postFunc?eval(action.value.postFunc):t=>t;for(const t of map.value)try{obj[t.id]&&(obj[t.id]=postFunc(obj[t.id])),isIgnore(t.srcText)?t.target.innerHTML=t.srcText:t.target.innerHTML=(a=obj[t.id])!=null?a:t.tgtText,t.newtgt=t.target.innerHTML}catch(o){console.log(o,t,isIgnore(t.srcText),obj[t.id])}}function upload_xliff(a){let t=new FileReader;t.readAsText(a.target.files[0],"UTF-8"),t.onload=XML2obj}function extract(){const a={};for(const t of map.value)a[t.id]=t.srcText;str2file(JSON.stringify(a),"sources.json")}function upload_target(a){let t=new FileReader;t.readAsText(a.target.files[0],"UTF-8"),t.onload=Json2obj}function save(){str2file(new XMLSerializer().serializeToString(xmlDoc),"result.xliff")}return(a,t)=>{const o=resolveComponent("a-form-item"),s=resolveComponent("a-input"),n=resolveComponent("a-form"),r=resolveComponent("a-tag"),c=resolveComponent("a-col"),u=resolveComponent("a-row"),d=resolveComponent("a-table");return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(n,{class:"actionbar",layout:"inline",model:action.value},{default:withCtx(()=>[createVNode(o,{label:"Home"},{default:withCtx(()=>[_hoisted_2]),_:1}),createVNode(o,{label:"PostFunc"},{default:withCtx(()=>[createVNode(s,{value:action.value.postFunc,"onUpdate:value":t[0]||(t[0]=l=>action.value.postFunc=l),"allow-clear":""},null,8,["value"])]),_:1}),createVNode(o,{label:"Filter"},{default:withCtx(()=>[createVNode(s,{value:action.value.searchVal,"onUpdate:value":t[1]||(t[1]=l=>action.value.searchVal=l),"allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"]),createVNode(n,{class:"confbar",layout:"inline",model:conf.value},{default:withCtx(()=>[createVNode(o,{label:"idName"},{default:withCtx(()=>[createVNode(s,{value:conf.value.idName,"onUpdate:value":t[2]||(t[2]=l=>conf.value.idName=l)},null,8,["value"])]),_:1}),createVNode(o,{label:"unitName"},{default:withCtx(()=>[createVNode(s,{value:conf.value.unitName,"onUpdate:value":t[3]||(t[3]=l=>conf.value.unitName=l)},null,8,["value"])]),_:1}),createVNode(o,{label:"srcName"},{default:withCtx(()=>[createVNode(s,{value:conf.value.srcName,"onUpdate:value":t[4]||(t[4]=l=>conf.value.srcName=l)},null,8,["value"])]),_:1}),createVNode(o,{label:"tgtName"},{default:withCtx(()=>[createVNode(s,{value:conf.value.tgtName,"onUpdate:value":t[5]||(t[5]=l=>conf.value.tgtName=l)},null,8,["value"])]),_:1}),createVNode(o,{label:"ignorePatterns"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(ignPats.value,l=>(openBlock(),createBlock(r,{key:l,closable:"",onClose:i=>removeTag(l)},{default:withCtx(()=>[createTextVNode(toDisplayString(l),1)]),_:2},1032,["onClose"]))),128)),newtag.value.input?(openBlock(),createBlock(s,{key:0,ref_key:"inputRef",ref:inputRef,value:newtag.value.val,"onUpdate:value":t[6]||(t[6]=l=>newtag.value.val=l),type:"text",size:"small",style:{width:"100px"},onBlur:handleInputConfirm,onKeyup:withKeys(handleInputConfirm,["enter"])},null,8,["value","onKeyup"])):(openBlock(),createBlock(r,{key:1,style:{background:"#fff","border-style":"dashed"},onClick:showInput},{default:withCtx(()=>[_hoisted_3]),_:1}))]),_:1})]),_:1},8,["model"]),_hoisted_4,createVNode(u,null,{default:withCtx(()=>[createVNode(c,{span:8},{default:withCtx(()=>[_hoisted_5,createBaseVNode("input",{type:"file",onChange:upload_xliff,accept:".xliff, text/xml"},null,32)]),_:1}),createVNode(c,{span:8},{default:withCtx(()=>[createVNode(u,{class:"btnrow"},{default:withCtx(()=>[createBaseVNode("button",{onClick:extract},"Extract Souces")]),_:1}),_hoisted_6,createVNode(u,{class:"btnrow"},{default:withCtx(()=>[createBaseVNode("button",{onClick:save},"Save")]),_:1})]),_:1}),createVNode(c,{span:8},{default:withCtx(()=>[_hoisted_7,createBaseVNode("input",{type:"file",onChange:upload_target,accept:".json, application/JSON"},null,32)]),_:1})]),_:1}),_hoisted_8,unref(filterData).length?(openBlock(),createBlock(d,{key:0,dataSource:unref(filterData),columns,rowKey:(l,i)=>i,class:"ant-table-striped","row-class-name":(l,i)=>i%2===1?"table-striped":null},null,8,["dataSource","rowKey","row-class-name"])):createCommentVNode("v-if",!0)])}}};var xmlparserVue=_export_sfc(_sfc_main$1,[["__scopeId","data-v-7048e968"]]),App_vue_vue_type_style_index_0_lang="";const _sfc_main={setup(a){return(t,o)=>(openBlock(),createBlock(xmlparserVue))}};var antd="";const app=createApp(_sfc_main);app.use(Antd).mount("#app");
